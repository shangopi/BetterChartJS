{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shang\\\\gitrepo\\\\BetterChartJS\\\\client\\\\src\\\\components\\\\Chart_Components\\\\ArcChart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const process_chart = data => {\n  const sourceNode = [];\n  const targetNode = [];\n  const weights = [];\n  var allNodesNo;\n\n  for (var i = 0; i < data.length; i++) {\n    if (data[i][2] === '') {\n      weights.push(Number(0));\n    } else {\n      weights.push(Number(data[i][2]));\n    }\n\n    if (!sourceNode.includes(data[i][0])) {\n      sourceNode.push(data[i][0]);\n    }\n  }\n\n  for (let i = 0; i < data.length; i++) {\n    if (!sourceNode.includes(data[i][1]) && !targetNode.includes(data[i][1])) {\n      targetNode.push(data[i][1]);\n    }\n  }\n\n  allNodesNo = sourceNode.length + targetNode.length;\n  const allNodeList = [...sourceNode, ...targetNode];\n  return [sourceNode, targetNode, weights, allNodeList, allNodesNo];\n};\n\nconst Canvas = props => {\n  _s();\n\n  const data = props.data;\n  const [radius_max, set_max] = useState(50);\n  let [sourceNode, targetNode, weights, allNodeList, allNodesNo] = process_chart(data);\n  const canvasRef = useRef(null);\n\n  const draw = ctx => {\n    const x1 = 70; //diagram staring position\n\n    const x2 = props.config.width; //diagram ending position\n\n    const l = (x2 - x1) / (allNodesNo - 1);\n    const highest_weight = Math.max(...weights);\n\n    for (let i = 0; i < allNodeList.length; i++) {\n      ctx.beginPath();\n      ctx.fillStyle = \"#000000\";\n      ctx.arc(x1 + i * l, radius_max, props.config.circle_size, 0, 2 * Math.PI, true);\n      ctx.fill();\n      ctx.beginPath();\n      ctx.font = props.config.label_size + \" \" + props.config.label_font;\n      ctx.fillStyle = \"#000000\";\n      ctx.textAlign = \"center\";\n\n      if (props.config.orientation == 0) {\n        ctx.fillText(allNodeList[i], x1 + i * l, radius_max + 30);\n      } else {\n        ctx.save();\n        ctx.translate(x1 + i * l - 6, radius_max + 30);\n        ctx.rotate(0.5 * Math.PI);\n        var rText = allNodeList[i];\n        ctx.textAlign = \"left\";\n        ctx.fillText(rText, 0, 0);\n        ctx.restore();\n      }\n\n      ctx.beginPath();\n      ctx.moveTo(x1, radius_max);\n      ctx.lineTo(x2, radius_max);\n      ctx.stroke();\n    }\n\n    for (let i = 0; i < data.length; i++) {\n      var source_position = allNodeList.indexOf(data[i][0]);\n      var target_position = allNodeList.indexOf(data[i][1]);\n      var x = x1 + source_position * l;\n      var num = Number(data[i][2]) / highest_weight * props.config.arc_strength;\n      var radius = (target_position - source_position) * l / 2;\n\n      if (Math.abs(radius) > radius_max) {\n        set_max(Math.abs(radius) + 40);\n      }\n\n      ctx.beginPath();\n      ctx.lineWidth = num;\n      ctx.strokeStyle = props.config.color1;\n\n      if (radius < 0) {\n        ctx.strokeStyle = props.config.color2;\n        ctx.arc(x + radius, radius_max, -radius, 0, Math.PI, true);\n      } else {\n        ctx.arc(x + radius, radius_max, radius, 0, Math.PI, true);\n      }\n\n      ctx.stroke();\n    }\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d'); //const { width, height } = canvas.getBoundingClientRect()\n\n    canvas.width = 1000;\n\n    if (props.config.orientation == 0) {\n      canvas.height = radius_max + 40;\n    } else {\n      canvas.height = radius_max + 150;\n    } //Our draw come here\n\n\n    draw(context);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [props.config.show_heading && /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: 'mt-5 text-center ',\n      style: {\n        fontFamily: props.config.title_font,\n        fontSize: props.config.title_size\n      },\n      children: \" Sample Arc Chart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 39\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n        className: \"{canvas1}\",\n        ref: canvasRef,\n        ...props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 28\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 8\n  }, this);\n};\n\n_s(Canvas, \"8VwufNHg8Y2vLIFt352nforUH1Y=\");\n\n_c = Canvas;\nexport default Canvas;\n\nvar _c;\n\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["React","useRef","useEffect","useState","process_chart","data","sourceNode","targetNode","weights","allNodesNo","i","length","push","Number","includes","allNodeList","Canvas","props","radius_max","set_max","canvasRef","draw","ctx","x1","x2","config","width","l","highest_weight","Math","max","beginPath","fillStyle","arc","circle_size","PI","fill","font","label_size","label_font","textAlign","orientation","fillText","save","translate","rotate","rText","restore","moveTo","lineTo","stroke","source_position","indexOf","target_position","x","num","arc_strength","radius","abs","lineWidth","strokeStyle","color1","color2","canvas","current","context","getContext","height","show_heading","fontFamily","title_font","fontSize","title_size","display","justifyContent","alignItems"],"sources":["C:/Users/shang/gitrepo/BetterChartJS/client/src/components/Chart_Components/ArcChart.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react'\r\n\r\nexport const process_chart = (data) =>{\r\n    const sourceNode=[];\r\n    const targetNode=[];\r\n    const weights=[];\r\n    var allNodesNo;\r\n    for(var i=0;i<data.length;i++){\r\n        if(data[i][2]===''){\r\n            weights.push(Number(0));\r\n        }\r\n        else{\r\n            weights.push(Number(data[i][2]));\r\n        }\r\n        \r\n        if(!sourceNode.includes(data[i][0])){\r\n            sourceNode.push(data[i][0]);\r\n        }\r\n    }\r\n\r\n    for(let i=0;i<data.length;i++){\r\n        if(!sourceNode.includes(data[i][1]) && !targetNode.includes(data[i][1])){\r\n            targetNode.push(data[i][1]);\r\n        }\r\n    }\r\n    allNodesNo=sourceNode.length+targetNode.length;\r\n    const allNodeList=[...sourceNode,...targetNode];\r\n\r\n    return [sourceNode,targetNode,weights,allNodeList,allNodesNo]\r\n\r\n}\r\n\r\n\r\nconst Canvas = props => {\r\n    const data = props.data;\r\n    const [radius_max,set_max] = useState(50);\r\n    let [sourceNode,targetNode,weights,allNodeList,allNodesNo] = process_chart(data);\r\n    \r\n    \r\n\r\n  const canvasRef = useRef(null);\r\n  \r\n  \r\n  const draw = ctx => {\r\n    const x1= 70; //diagram staring position\r\n    const x2 =props.config.width; //diagram ending position\r\n    const l = (x2-x1)/(allNodesNo-1);\r\n    const highest_weight=Math.max(...weights);\r\n\r\n\r\n  \r\n    for(let i = 0;i< allNodeList.length;i++){\r\n        ctx.beginPath();\r\n\r\n        ctx.fillStyle=\"#000000\"\r\n        ctx.arc(x1+i*l, radius_max , props.config.circle_size , 0, 2*Math.PI,true);\r\n        ctx.fill();\r\n\r\n        \r\n        \r\n        ctx.beginPath();\r\n        ctx.font = props.config.label_size + \" \"+ props.config.label_font;\r\n        ctx.fillStyle= \"#000000\";\r\n        ctx.textAlign = \"center\";\r\n        if(props.config.orientation == 0){\r\n            ctx.fillText(allNodeList[i],x1+i*l,radius_max + 30)\r\n        }\r\n        else{\r\n            ctx.save();\r\n            ctx.translate(x1+i*l - 6,radius_max + 30);\r\n            ctx.rotate(0.5*Math.PI);\r\n\r\n            var rText = allNodeList[i];\r\n            ctx.textAlign = \"left\";\r\n            ctx.fillText(rText , 0, 0);\r\n            ctx.restore();\r\n        }   \r\n        \r\n        \r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(x1,radius_max );\r\n        ctx.lineTo(x2,radius_max );\r\n        ctx.stroke();\r\n    }\r\n\r\n    \r\n    for(let i=0;i<data.length;i++){\r\n       \r\n        var source_position = allNodeList.indexOf(data[i][0]);\r\n        var target_position = allNodeList.indexOf(data[i][1]);\r\n        var x=x1 + source_position*l;\r\n        var num= ((Number(data[i][2]))/highest_weight)*props.config.arc_strength;\r\n        var radius = ((target_position-source_position)*l/2);\r\n        if(Math.abs(radius)>radius_max){\r\n            set_max(Math.abs(radius)+40);\r\n            \r\n        }\r\n        \r\n        ctx.beginPath();\r\n        ctx.lineWidth=num;\r\n        ctx.strokeStyle=props.config.color1;\r\n        if (radius<0){\r\n            ctx.strokeStyle=props.config.color2;\r\n            ctx.arc(x+radius, radius_max , -radius, 0, Math.PI,true);\r\n        }\r\n        else{\r\n            ctx.arc(x+radius, radius_max , radius, 0, Math.PI,true);\r\n        }\r\n        ctx.stroke();\r\n    }\r\n    \r\n  }\r\n  \r\n \r\n\r\n  \r\n  useEffect(() => {\r\n    \r\n    const canvas = canvasRef.current\r\n    const context = canvas.getContext('2d')\r\n    //const { width, height } = canvas.getBoundingClientRect()\r\n    canvas.width=1000;\r\n    if(props.config.orientation ==0){\r\n        canvas.height=radius_max + 40;\r\n    }\r\n    else{\r\n        canvas.height=radius_max + 150;\r\n    }\r\n    \r\n    \r\n    //Our draw come here\r\n    draw(context)\r\n  })\r\n  \r\n\r\n\r\n   return ( \r\n       <div>\r\n        \r\n        {props.config.show_heading && <h2 className={'mt-5 text-center '} style={{fontFamily : props.config.title_font, fontSize: props.config.title_size}}> Sample Arc Chart</h2> }\r\n        <div  style={{\r\n     display: \"flex\",    justifyContent: \"center\",\r\n    alignItems: \"center\"}}><canvas className='{canvas1}'  ref={canvasRef} {...props}/></div>\r\n\r\n\r\n      </div>\r\n     );\r\n     \r\n}\r\n\r\n\r\n\r\nexport default Canvas"],"mappings":"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"},"metadata":{},"sourceType":"module"}